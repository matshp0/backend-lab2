generator kysely {
  provider        = "prisma-kysely"
  output          = "../src/db"
  fileName        = "types.ts"
  enumFileName    = "enums.ts"
  previewFeatures = ["postgresqlExtensions"]
}

datasource db {
  provider   = "postgresql"
  url        = env("DATABASE_URL")
  extensions = [uuidOssp(map: "uuid-ossp")]
}

model category {
  id      String   @id @default(dbgenerated("uuid_generate_v4()"))
  name    String
  records record[] @relation("CategoryRecords")
}

model record {
  id         String   @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  createdAt  DateTime @default(now()) @db.Timestamp(6)
  userId     String   @db.Uuid
  categoryId String
  cost       Decimal  @db.Decimal

  category category @relation("CategoryRecords", fields: [categoryId], references: [id], onUpdate: NoAction, map: "fk_record_category")
  user     user     @relation("UserRecords", fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_record_user")
}

model user {
  id      String   @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  name    String
  records record[] @relation("UserRecords")
}
